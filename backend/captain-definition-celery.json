{
  "schemaVersion": 2,
  "dockerfileLines": [
    "FROM python:3.12-slim",
    "",
    "# VariÃ¡veis de ambiente",
    "ENV PYTHONUNBUFFERED=1",
    "ENV PYTHONDONTWRITEBYTECODE=1",
    "ENV ENVIRONMENT=production",
    "",
    "# Instalar dependÃªncias do sistema",
    "RUN apt-get update && apt-get install -y \\",
    "    gcc \\",
    "    postgresql-client \\",
    "    && rm -rf /var/lib/apt/lists/*",
    "",
    "# Criar diretÃ³rio de trabalho",
    "WORKDIR /app",
    "",
    "# Copiar requirements e instalar dependÃªncias Python",
    "COPY requirements.txt /app/",
    "RUN pip install --no-cache-dir --upgrade pip && \\",
    "    pip install --no-cache-dir -r requirements.txt",
    "",
    "# Copiar cÃ³digo da aplicaÃ§Ã£o",
    "COPY . /app/",
    "",
    "# Script de inicializaÃ§Ã£o do Celery Worker",
    "RUN echo '#!/bin/bash\\nset -e\\necho \"ðŸ“¦ Aplicando migrations...\"\\npython manage.py migrate --noinput\\necho \"âœ… Migrations aplicadas\"\\necho \"ðŸš€ Iniciando Celery Worker...\"\\ncelery -A config worker -l info' > /app/start-celery.sh && chmod +x /app/start-celery.sh",
    "",
    "# Comando para iniciar Celery Worker",
    "CMD [\"/app/start-celery.sh\"]"
  ]
}

